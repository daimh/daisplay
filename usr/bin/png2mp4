#!/usr/bin/env bash
#20191121
set -e
if [ -f slideshow.mp4 ]
then
	echo "file slideshow.mp4 already exists, rename or remove it first!"
	exit 1
fi
LAST="$(ls *.png | tail -n 1)"
if [[ -h "$LAST" && $LAST == *-png2mp4.png ]]
then
	echo "$LAST seems to be a leftover file from last png2mp4 run, rm it please"
	exit 1
fi 
DUP="$(echo $LAST | sed -e "s/\.png/-png2mp4.png/")"
ln -s "$LAST" "$DUP"
mencoder mf://*.png -mf w=1080:h=1080:fps=0.3:type=png -ovc lavc -lavcopts vcodec=mpeg4:mbd=2 -o slideshow.mp4
rm "$DUP"
